import{_ as z,u as G,m as M,J as R,r as f,p as $,o as U,h as q,a as u,c as i,d as t,b as p,s as A,j as b,q as c,n as D,w as y,v as k,y as J,k as T,F as x,e as j,f as H,g as K,E as O,G as Q,N as P}from"./index.a21a5dcc.js";import{_ as W,a as X}from"./PostLoadingCard.6df2b182.js";import{P as Y}from"./PostEmptyCard.f1b44f03.js";import{_ as Z}from"./PostCard.8df21cd5.js";import{u as ee,a as se}from"./useChat.0987ab2f.js";import{a as te}from"./apiPost.42382d2e.js";import"./UserInfo.e9f4b524.js";import"./apiLike.ada2134e.js";const B=m=>(O("data-v-648f449d"),m=m(),Q(),m),ae={class:"track relative mb-4 flex rounded-lg border-2 border-black bg-white"},oe={class:"flex w-full justify-between p-4"},le={key:0,class:"flex items-center justify-center"},re=B(()=>t("span",null,"\u50B3\u9001\u8A0A\u606F",-1)),ne={key:0},ue=B(()=>t("p",{class:"p-8 text-center text-subtitle"}," \u76EE\u524D\u5C1A\u7121\u52D5\u614B\uFF0C\u65B0\u589E\u4E00\u5247\u8CBC\u6587\u5427\uFF01 ",-1)),ie={setup(m){const F=G(),S=M(),C=R(),d=f(C.params.id),v=f(!1),r=f(!0),{handleRoom:N}=ee(),E=async()=>{var o;if(v.value)return;const e={receiver:d.value};try{v.value=!0;const s=await se.room(e);if(!(s!=null&&s.status))return;N(s==null?void 0:s.data)}catch(s){const a=(o=s.response.data)==null?void 0:o.message;a&&F.error(a)}finally{v.value=!1}},I=f([]),h=(e=1,o="")=>{let s="new",a="";e===2&&(s="old"),e===3&&(a="hot"),te.getAll(`timeSort=${s}&search=${o}&likesSort=${a}&limit=9999`).then(n=>{r.value=!1,I.value=n.data.data}).catch(n=>{r.value=!1,console.log(n)})},g=$(()=>I.value.filter(e=>{var o;return((o=e.userId)==null?void 0:o._id)===d.value}));U(()=>{h()});const l=f({}),_=()=>{r.value=!0,P.getProfile(d.value).then(e=>{r.value=!1,l.value=e.data.data}).catch(e=>{r.value=!1,console.log(e)})},w=$(()=>{var s;return(l.value.followers?l.value.followers:[]).map(a=>a.user).includes((s=S.user)==null?void 0:s.id)});U(()=>{_()});const L=()=>{w.value?P.deleteFollow(l.value.id).then(()=>{_()}).catch(e=>{console.log(e)}):P.follow(l.value.id).then(()=>{_()}).catch(e=>{console.log(e)})};return q(C,e=>{e.name==="profile"&&e.params.id&&(d.value=e.params.id,h(),_())}),(e,o)=>{var s,a;return u(),i(x,null,[t("div",ae,[t("div",null,[p(A,{"img-url":l.value.avatar,size:"80"},null,8,["img-url"])]),t("div",oe,[t("div",null,[t("h2",null,b(l.value.name),1),t("span",null,b((s=l.value.followers)==null?void 0:s.length)+" \u4EBA\u8FFD\u8E64",1)]),d.value!==((a=c(S).user)==null?void 0:a.id)?(u(),i("div",le,[t("button",{type:"button",class:D(["rounded-lg border-2 border-black px-8 py-1.5 shadow-post hover:bg-primary hover:text-white",c(w)?"bg-secondary":"bg-warning"]),onClick:L},b(c(w)?"\u53D6\u6D88\u8FFD\u8E64":"\u8FFD\u8E64"),3),t("button",{onClick:E,class:"ml-2 flex items-center justify-center rounded-lg border-2 border-black px-6 py-1.5 shadow-post"},[re,y(p(J,{class:"ml-1 h-4 w-4 animate-spin"},null,512),[[k,v.value]])])])):T("",!0)])]),p(W,{onGetPosts:h}),y(t("ul",null,[(u(),i(x,null,j(3,n=>t("li",{key:n,class:"mb-4"},[p(X)])),64))],512),[[k,r.value]]),y(t("div",null,[c(g).length>0?(u(),i("ul",ne,[(u(!0),i(x,null,j(c(g),(n,V)=>(u(),i("li",{key:V,class:D({"mb-4":V<c(g).length-1})},[p(Z,{post:n},null,8,["post"])],2))),128))])):(u(),H(Y,{key:1},{default:K(()=>[ue]),_:1}))],512),[[k,!r.value]])],64)}}};var ge=z(ie,[["__scopeId","data-v-648f449d"]]);export{ge as default};
