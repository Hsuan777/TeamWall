import{_ as M,G as z,H as E,u as A,C as H,r as p,J as V,o as $,h as J,a as n,c,d as s,b as f,l as K,t as y,k as u,n as B,w as k,v as x,K as T,j as q,F as P,e as D,f as O,g as Q,x as W,y as X,L as Y,M as Z,N as S}from"./index.c53ac51d.js";import{_ as ee,a as se}from"./PostLoadingCard.df12d2d9.js";import{P as te}from"./PostEmptyCard.48ad4934.js";import{_ as ae}from"./PostCard.6c94ebf6.js";import{a as oe}from"./apiChat.3c4ccf35.js";import{a as le}from"./apiPost.a4869b45.js";import"./apiLike.8ed4e19c.js";const R=m=>(W("data-v-51d2744c"),m=m(),X(),m),re={class:"track relative mb-4 flex rounded-lg border-2 border-black bg-white"},ne={class:"flex w-full justify-between p-4"},ce={key:0,class:"flex items-center justify-center"},ue=R(()=>s("span",null,"\u50B3\u9001\u8A0A\u606F",-1)),ie={key:0},de=R(()=>s("p",{class:"p-8 text-center text-subtitle"}," \u76EE\u524D\u5C1A\u7121\u52D5\u614B\uFF0C\u65B0\u589E\u4E00\u5247\u8CBC\u6587\u5427\uFF01 ",-1)),pe={setup(m){const j=z(),F=E(),I=A(),C=H(),i=p(C.params.id),v=p(!1),l=p(!1),L=async()=>{if(v.value)return;const e={receiver:i.value};try{v.value=!0;const t=await oe.room(e),{data:{status:a,roomId:o,name:d,avatar:g,_id:G}}=t;if(a){if(F.updateRoom({roomId:o,name:d,avatar:g,receiver:G}),Y()!=="desktop"){j.push("/chat-room");return}Z.emit("handleRoom",!0)}}catch(t){console.log("error",t)}finally{v.value=!1}},U=p([]),_=(e=1,t="")=>{let a="desc";e===2&&(a="asc"),l.value=!0,le.getAll(`timeSort=${a}&search=${t}`).then(o=>{l.value=!1,U.value=o.data.data}).catch(o=>{l.value=!1,console.log(o)})},w=V(()=>U.value.filter(e=>{var t;return((t=e.userId)==null?void 0:t._id)===i.value}));$(()=>{_()});const r=p({}),h=()=>{l.value=!0,S.getProfile(i.value).then(e=>{l.value=!1,r.value=e.data.data}).catch(e=>{l.value=!1,console.log(e)})},b=V(()=>{var a;return(r.value.followers?r.value.followers:[]).map(o=>o.user).includes((a=I.user)==null?void 0:a.id)});$(()=>{h()});const N=()=>{b.value?S.deleteFollow(r.value.id).then(()=>{h()}).catch(e=>{console.log(e)}):S.follow(r.value.id).then(()=>{h()}).catch(e=>{console.log(e)})};return J(C,e=>{e.name==="profile"&&e.params.id&&(i.value=e.params.id,_(),h())}),(e,t)=>{var a,o;return n(),c(P,null,[s("div",re,[s("div",null,[f(K,{"img-url":r.value.avatar,size:"80"},null,8,["img-url"])]),s("div",ne,[s("div",null,[s("h2",null,y(r.value.name),1),s("span",null,y((a=r.value.followers)==null?void 0:a.length)+" \u4EBA\u8FFD\u8E64",1)]),i.value!==((o=u(I).user)==null?void 0:o.id)?(n(),c("div",ce,[s("button",{type:"button",class:B(["rounded-lg border-2 border-black px-8 py-1.5 shadow-post hover:bg-primary hover:text-white",u(b)?"bg-secondary":"bg-warning"]),onClick:N},y(u(b)?"\u53D6\u6D88\u8FFD\u8E64":"\u8FFD\u8E64"),3),s("button",{onClick:L,class:"ml-2 flex items-center justify-center rounded-lg border-2 border-black px-6 py-1.5 shadow-post"},[ue,k(f(T,{class:"ml-1 h-4 w-4 animate-spin"},null,512),[[x,v.value]])])])):q("",!0)])]),f(ee,{onGetPosts:_}),k(s("ul",null,[(n(),c(P,null,D(3,d=>s("li",{key:d,class:"mb-4"},[f(se)])),64))],512),[[x,l.value]]),k(s("div",null,[u(w).length>0?(n(),c("ul",ie,[(n(!0),c(P,null,D(u(w),(d,g)=>(n(),c("li",{key:g,class:B({"mb-4":g<u(w).length-1})},[f(ae,{post:d,onGetPosts:_},null,8,["post"])],2))),128))])):(n(),O(te,{key:1},{default:Q(()=>[de]),_:1}))],512),[[x,!l.value]])],64)}}};var be=M(pe,[["__scopeId","data-v-51d2744c"]]);export{be as default};
